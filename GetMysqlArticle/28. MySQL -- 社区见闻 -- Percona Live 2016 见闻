<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>MySQL · 社区见闻 · Percona Live 2016 见闻</title>
  <meta name="description" content="前言">

  <link rel="stylesheet" href="/monthly/css/typo.css">
  <link rel="stylesheet" href="/monthly/css/animate.css">
  <link rel="stylesheet" href="/monthly/css/main.css">
  <link rel="canonical" href="http://mysql.taobao.org//monthly/2016/10/03/">
  <link rel="alternate" type="application/rss+xml" title="数据库内核月报" href="http://mysql.taobao.org//monthly/feed.xml" />

  <link rel="stylesheet" href="//cdn.staticfile.org/highlight.js/8.3/styles/tomorrow.min.css">
  <script src="/monthly/js/highlight.min.js"></script>
  <!-- <link rel="stylesheet" href="/monthly/themes/tomorrow.css">
  <script src="/monthly/highlight/highlight.pack.js"> -->
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="http://cdn.staticfile.org/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://cdn.staticfile.org/jquery/1.11.1/jquery.min.map"></script>

  <script src="/monthly/scripts/changeTarget.js"></script>
  
</head>


<!-- Google Analysis -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62056244-1', 'auto');
  ga('send', 'pageview');
</script>


  <body>

    <header>

  <a id="go-back-home" href="/monthly/2016/10">
    <h1>数据库内核月报 － 2016 / 10</h1>
  </a>

</header>


        <section class="paging">
  
  
  

  
    
      <div class="left">
        <a href="/monthly/2016/10/02/">
          ‹
        </a>
      </div>
    
  
  
    
      <div class="right">
        <a href="/monthly/2016/10/04/">
          ›
        </a>
      </div>
    
  
</section>


<div id = "container" class = "animated zoomIn">
  <div class="block">
  <nav id="primary_nav_wrap">
<ul>
  <li><a href="#">当期文章</a>
    <ul  class = "animated">
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/01/" target="_blank">
                
                AliSQL · 社区动态 · 关于开源之后评论的评论
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/02/" target="_blank">
                
                MySQL · 社区见闻 · Oracle Open World 2016 见闻
              </a>
            </li>
          
      
          
          

          
            
              <li class="current-menu-item">
            
              <a href="/monthly/2016/10/03/" target="_blank">
                
                MySQL · 社区见闻 · Percona Live 2016 见闻
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/04/" target="_blank">
                
                MySQL · 社区见闻 · MariaDB Developer Meeting 2016
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/05/" target="_blank">
                
                MySQL · myrocks · data dictionary 分析
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/06/" target="_blank">
                
                MySQL · 源码分析 · 无法revoke单库或单表权限
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/07/" target="_blank">
                
                PgSQL · 代码浅析 · PostgreSQL 可靠性分析
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/08/" target="_blank">
                
                PgSQL · 代码浅析 · PostgreSQL 9.6 聚合OP复用的优化分析
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/09/" target="_blank">
                
                MySQL · 特性分析 · 直方图的实现与分析
              </a>
            </li>
          
      
          
          

          
            
              <li>
            
              <a href="/monthly/2016/10/10/" target="_blank">
                
                SQL Server · 最佳实践 · 参数嗅探问题
              </a>
            </li>
          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
          
          

          
      
    </ul>
  </li>
</ul>
</nav>

    <div class="title">
      <h2>
        
        MySQL · 社区见闻 · Percona Live 2016 见闻
      </h2>
    </div>
  </div>
  <div class="content typo">
    <section class="post">
      <h2>前言</h2>

<p>今年的 Percona Live 时间很凑巧，正好夹在 Oracle Open World 和 MariaDB 开发者大会之间，而且跟 MariaDB 开发者大会一样在阿姆斯特丹，因此蹭了 MariaDB Foundation 的免费票去参加了 Percona Live。</p>

<p>从纽约飞阿姆斯特丹时，从芬兰赫尔辛基中转呆了一天，承蒙祖师爷 Monty 厚爱到他家住了一天，简直就是黑客帝国……</p>

<p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/9b76824011a38dc3eddf9e57ea92661a" alt="IMG_4176" /></p>

<p>他家所有的电器设备都可以通过这个中控系统来控制，还可以远程控制。在参加云栖大会的时候他还给我们同事演示了一番，估计他老婆在家里看到灯一会开一会关心里想：这货又在给谁演示远程系统了-_-|||</p>

<p>早上九点到老爷子家，他已经在工作室 Coding 了；下午三点才给我弄了一块鱼片，已经饿成狗了，10分钟吃完又去干活了……晚上8点才出来做晚饭，9点收拾完又去工作了……第二天一早去阿姆斯特丹6点出发，老子说昨天 Review Code 比较晚，只睡了2小时，一上飞机他就直接睡了。</p>

<p>不知道要是我们这么有钱，这么有名望后，这么老还能不能这样努力的工作……</p>

<p>闲扯到此打住，我们来看看今年的 Percona Live 有哪些主题和消息。</p>

<h2>主题</h2>

<p>今年的主题大户，基本上还是老样子，Percona 自己的主题占了半壁江山，Oracle 原厂占了剩下的大部分，然后 Facebook 和 Booking 依然是民间大厂主题最多的。</p>

<p>现场有差不多10个 Room 同时在进行 Topic，很多主题时间重叠，我只能挑选一部分参加，Oracle 的主题基本上在 Oracle  Open World 都讲过了，连人都没换 -_-!!! 所以也就没去听。</p>

<h3>Percona</h3>

<p>Colin 从 MariaDB 跳槽到 Percona 后第一次出来分享，他这次讲的是如何保证 MySQL/MariaDB 的安全性。</p>

<p>从登陆开始，他提出了包括应该使用 Auth_socket，或者使用远程鉴权，Windows可以用Active Directory。</p>

<p>使用中应该使用 SSL 协议进行传输加密，文件应该使用加密规则对数据文件进行加密防止文件拖库。</p>

<p>这里 MySQL 和 MariaDB 还有点不同，MySQL 只对数据文件本身加密，也就是说如果 Binlog 被拖走了，或者 Redo 被拖走了，还是有机会还原出数据的。<br />
MariaDB 首先它能支持 Amazon 的 KMS，远程获取密钥，这算是跟 Amazon 做的定制。并且可以根据 KMS 提供的更新密码后台异步更新文件的加密，也就是说执行过程中密钥还可以更换。<br />
此外 MariaDB 对所有内容都加密了，除了数据文件，还有 Binlog 和 Redo，这一点 Monty 确实考虑的更全面，这样哪怕整个机器都被人搬走了，只要密钥服务器还在，就没法破解数据。</p>

<p>从这些细节也可以看出 Monty 对 MariaDB 的规划：二进制功能兼容，但是使用不同的代码。</p>

<p>这样有好处有坏处，好处是代码不用跟着 MySQL 走，不用等待官方小版本升级，有 Bugfix 直接抠出代码来 Port；坏处是像我们这些写Patch的人，提给两边的 Patch 可能差异会越来越大。</p>

<p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/3b482fd884821dac8a9f46fe15dd13c0" alt="IMG_4184" /></p>

<h3>Booking</h3>

<p>然后听了下 Booking 怎么利用 Multi-Source Replication 来进行数据重分布。不约而同，我们也是用Multi-Source 来对数据进行重分布，这是目前主要的用处，英雄所见略同。</p>

<p>然而，我开发这个功能的初衷是为了能用一台大主机完成多个实例的备份，减少主主复制中对空闲备机的浪费，不过现在好像也没谁拿 Multi-Source 这么用，淡淡的忧伤。反正，有用就好，开源么就是为了造福大家，怎么开心怎么用。</p>

<p>Anyway，自己写的功能在这些高大上的传说中的网站被使用，还是有点小激动。这么多人热爱开源，参与开源的动力也就是来源于此吧。</p>

<p>当然 Booking 希望 Multi-Source 也能支持Semi-Sync，正好，这个我在 Double Sync 这个补丁中已经顺手写完了，再走完开源流程后就可以公开，跟 Monty 提了后正好他也有这个计划，现在他就不用动了，等着我的补丁开源，也许不多久在 MariaDB/MySQL 中就可以看到每个通道都可以设置不同的 Semi-Sync 状态了。</p>

<p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/824df94e28aa7267501d38269eaef2b5" alt="IMG_4185" /></p>

<p>PS. Booking的MySQL工程师基本都是长发飘飘的…………汉子！</p>

<h3>Facebook</h3>

<p>Facebook 今年讲了好几个主题都多少跟 RocksDB 有点关系，真的是不遗余力的强推他们自己的产品。</p>

<p>Yoshinori 和 Mark 两位老司机轮番上场，从内核设计到实践应用，全方面介绍RocksDB。</p>

<p>RocksDB 本质上是基于 LevelDB 的，也就是 LSM-Tree 的结构，因此对写有天然的优势。然后 Facebook 针对 Timeline 的业务特点做了很多改进，支持了事务，还可以做快照。</p>

<p>总之跟 Mark 聊下来就是我们啥都支持，现在不支持的也马上要支持，你赶紧用就得了…… 聊 TokuDB 和 RocksDB 的对比，他认为所有方面 RocksDB 都吊打 TokuDB，这个我们还需要自己测试后才能下结论。</p>

<p>Facebook 自己提供的测试数据上看确实是这样，但是到底是 Benchmark 还是 Benchmarketing，一定要自己测试。（原谅我的拍照水平渣画质，可以在 Percona Live 的网站上找到原始PPT）</p>

<p>另外十二月的 CMUG 年底大会，Yoshinori 和 Mark 也会组团来国内分享 RocksDB，到时候可以深入交流。</p>

<p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/ba9d681722ae1730ae94776b4f15f803" alt="IMG_4186" /></p>

<h3>Alexey</h3>

<p>Sysbench 的作者 Alexey 离开 Percona 后作为个体户这次也来讲了他的工作 —— MySQL on ARM，这也是个很牛逼的项目。</p>

<p>很有幸前段时间跟 Alexey 一起在阿里共同为 MySQL 适配 ARM 做了一点微小的工作，因此对一些细节也是比较了解的，不过 Alexey 回家后继续做了更多深入的工作，例如当时在公司调试我们并没有调通 TokuDB 在 ARM 上的编译，现在他终于搞定了。</p>

<p>ARM 和 x86 在体系结构和指令集上都有很大的差异，包括 Cache Line 不一样，会影响 CPU Cache 对齐；ARM的核数动辄四五十Core，在多核上的问题也比 x86 突出的多；此外还有更突出的 NUMA 问题，GCC 编译问题，指令集结果差异等问题，Alexey 一一予以了解决，还发现了官方本身 Test Case 在 x86 上就存在的一些问题。</p>

<p>Alexey 对这方面做了大量的改动，并且在他的GitHub资源里放了 ARM 版 MySQL 的源码，如果想试试 ARM 的同学可以到他的 GitHub去下载：https://github.com/akopytov/cavium-mysql</p>

<p>Geek 都有一个特点，问题不彻底搞明白，是睡不着觉的，这些活都是没算在付费服务里面的，是他自己觉得一定要彻底搞清楚这些问题。</p>

<p><img src="http://ata2-img.cn-hangzhou.img-pub.aliyun-inc.com/bc054b793da832eb84cb6d867b4e9d71" alt="IMG_4187" /></p>

<h2>总结</h2>

<p>今年的Percona Live最重要的就两个事：<br />
1. MySQL 8.0 要来了，跟 OOW 上一样无数的主题狂轰滥炸给 8.0 造势。<br />
2. MyRocks/RockDB 是今年最火的引擎，FB 不遗余力的投入。</p>

<p>关于 8.0，对用户来说可能感觉还不错，但对我们这些内核开发者来说，跟 InnoDB 绑定太紧，是福是祸真不好说……<br />
关于 RocksDB，无论如何也应该试一下，尤其是你在用 TokuDB 的话，毕竟 Percona 已经不太维护了（主要是没有资深开发者了），RocksDB 有 Facebook 一个整团队在维护，并且自己也在大规模用，未必不是一个好的选择。</p>


    </section>
  </div>
</div>


    <footer>
  <a href="http://mysql.taobao.org/" target="_blank" class="muted">阿里云RDS-数据库内核组</a>
  <br>
  <a href="https://github.com/alibaba/AliSQL" target="_blank" class="muted">欢迎在github上star AliSQL</a>
</br>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">知识共享署名-非商业性使用-相同方式共享 3.0 未本地化版本许可协议</a>进行许可。
</footer>

<script type="text/javascript">
  jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
      //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
      offset_opacity = 1200,
      //duration of the top scrolling animation (in ms)
      scroll_top_duration = 700,
      //grab the "back to top" link
      $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
      ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
      if( $(this).scrollTop() > offset_opacity ) {
        $back_to_top.addClass('cd-fade-out');
      }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
      event.preventDefault();
      $('body,html').animate({
        scrollTop: 0 ,
        }, scroll_top_duration
      );
    });

  });
</script>



    <a href="#0" class="cd-top"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="10px"
   width="38px" height="60px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
      <polygon fill="#FFFFFF" points="8,2.8 16,10.7 13.6,13.1 8.1,7.6 2.5,13.2 0,10.7 "/>
    </svg>
    </a>
  </body>

</html>
